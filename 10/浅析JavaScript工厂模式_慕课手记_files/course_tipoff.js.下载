define(function(){$("body").on("click",".js-tip-off",function(){var a=$(this),v=a.data("type"),h=a.data("uid"),j=a.data("id"),y=a.data("src");return isLogin?($(".js-tipoff-typebox").find(".tipoff-loading").show(),$(".js-tipoff-block").show(),$(".js-tipoff-box").show(),$.ajax({url:"/service/reporttypes",type:"POST",dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0,success:function(a){if(0==a.status){var v=a.data,h=$(".js-tipoff-typebox"),j="";$.each(v,function(i){j+='<div class="item l">                                    <i class="l icon-checkbox_o js-tipoff-select" data-type="'+v[i].id+'"></i>                                    <p class="l">'+v[i].name+"</p>                                </div>"}),h.find(".tipoff-loading").hide(),h.append(j)}else $.prompt(a.msg,{icon:"error"}),c=0},error:function(){$.prompt("举报接口异常！",{icon:"error"}),c=0},complete:function(){c=0}}),void $(".js-tipoff-submit").attr({"data-type":v,"data-uid":h,"data-id":j,"data-src":y})):void $("#js-signin-btn").click()}),$(".js-tipoff-typebox").on("click",".js-tipoff-select",function(){var a=$(this),c=a.data("type"),v=$(".tipoff-type-box").find(".js-tipoff-select"),h=function(a){a.hasClass("on")?(a.removeClass("on icon-checkbox"),$(".js-tipoff-submit").attr("data-tipofftype","")):($.each(v,function(i,a){$(a).removeClass("icon-checkbox").removeClass("on")}),a.addClass("icon-checkbox on"),$(".js-tipoff-submit").attr("data-tipofftype",c))};h(a)});var a=function(){$(".js-tipoff-block").hide(),$(".js-tipoff-box").hide();var a='<div class="tipoff-loading">                        <div class="bounce1"></div>                        <div class="bounce2"></div>                        <div class="bounce3"></div>                    </div>';$(".js-tipoff-typebox").html(a),$(".js-tipoff-desc").val(""),$(".tipoff-text").find(".js-tipoff-text").html("0").css("color","#93999F");var c=$(".tipoff-type-box").find(".js-tipoff-select");$.each(c,function(i,a){$(a).removeClass("icon-checkbox").removeClass("on")}),$(".js-tipoff-submit").attr({"data-type":"","data-uid":"","data-id":"","data-tipofftype":""})};$(".js-tipoff-close").on("click",function(){a()}),$(".js-tipoff-desc").keyup(function(){var a=$(this),c=$(".tipoff-text").find(".js-tipoff-text"),v=$.trim(a.val().replace(/[\r\n]/g,"")).length;v>150?c.html(v).css("color","#f01414"):c.html(v).css("color","#93999f")});var c=0;$(".js-tipoff-submit").on("click",function(){var v=$(this),h=v.attr("data-uid"),j=v.attr("data-type"),y=v.attr("data-id"),b=v.attr("data-tipofftype"),g=$.trim($(".js-tipoff-desc").val().replace(/[\r\n]/g,"")),k=v.attr("data-src");if("undefined"!=typeof k&&0!=$.trim(k).length&&""!=k)var w=window.location.origin+$.trim(k);else var w=window.location.href;if(c)return void $.prompt("操作频繁，请稍后",{icon:"error"});if("undefined"==typeof b||""==b)return void $.prompt("请选择举报类型！",{icon:"error"});if(g.length>150)return void $.prompt("举报理由字数超限，请重新输入!",{icon:"error"});var C={report_type:b,page_url:w,reported_uid:h,reported_type:j,reported_type_id:y};0!=g.length&&(C.report_desc=g),c=1,$.ajax({url:"/service/report",data:C,type:"POST",dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0,success:function(v){0==v.status?($.prompt(v.msg,{icon:"success"}),c=0,a()):-110==v.status?($.prompt(v.msg,{icon:"error"}),a(),c=0):-11==v.status?($.prompt(v.msg,{icon:"error"}),window.location.reload()):($.prompt(v.msg,{icon:"error"}),c=0)},error:function(){$.prompt("接口异常！",{icon:"error"}),c=0},complete:function(){c=0}})})});